(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{134:function(e,t,a){},164:function(e,t,a){},192:function(e,t,a){e.exports=a(391)},197:function(e,t,a){},198:function(e,t,a){},199:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},384:function(e,t,a){},385:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){},389:function(e,t,a){},390:function(e,t,a){},391:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(5),r=a.n(i),o=(a(197),a(10)),c=a(11),l=a(13),u=a(12),m=a(14),p=a(28),d=a(22),h=(a(198),a(406)),f=a(403),E=a(398),g=a(400),y=a(7),b=a(35),v=(a(199),a(112),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onClose=function(){a.setState({visible:!1,isLogin:!0})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||console.log("Received values of form: ",t)})},a.compareToUserEmail=function(){var e={email:a.state.email};""===a.state.email?a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input your E-mail address"}):/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(a.state.email)?fetch("http://www.picchat.me/users/verifyEmail",{method:"POST",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.text().then(function(e){"failure"!==JSON.parse(e).status?a.setState({callbackResultEmail:"error",callbackTextEmail:"This E-mail do not existed."}):a.setState({callbackResultEmail:"success",callbackTextEmail:"Welcome Back!"})})}):a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input correct E-mail format!"})},a.postData=function(){""===a.state.email&&a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input your E-mail address"});var e={email:a.state.email,password:a.state.password};a.props.form.validateFields(function(t){t||fetch("http://www.picchat.me/users/login",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){"failure"===e.status?h.a.error(e.message+"!Please try again!"):e.user.email===a.state.email?(a.setState({isLogin:!0,login_username:e.user.name}),window.location.reload()):(a.setState({isLogin:!1}),h.a.success("Login False"),window.location.reload())})})},a.state={isLogin:!1,login_username:"",visible:!0,email:"",password:"",result:"",callbackResultEmail:"",callbackTextEmail:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={pathname:"/",query:{name:this.state.login_username,email:this.state.email,id:"",status:!0}};return this.state.isLogin?s.a.createElement(d.a,{to:t}):s.a.createElement("div",{id:"login"},s.a.createElement("div",{id:"login_form"},s.a.createElement(f.a,{title:"Login",width:360,onClose:this.onClose,visible:this.state.visible},s.a.createElement(E.a,{onSubmit:this.handleSubmit,className:"login-form"},s.a.createElement(E.a.Item,{hasFeedback:!0,validateStatus:this.state.callbackResultEmail,help:this.state.callbackTextEmail},e("eamil",{rules:[{required:!0,message:"Please input your E-mail."}]})(s.a.createElement(g.a,{prefix:s.a.createElement(y.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"E-mail",onBlur:this.compareToUserEmail,onChange:this.handleChangeEmail.bind(this)}))),s.a.createElement(E.a.Item,{hasFeedback:!0},e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(s.a.createElement(g.a.Password,{prefix:s.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onChange:this.handleChangePassword.bind(this)}))),s.a.createElement(E.a.Item,null,s.a.createElement(b.a,{type:"primary",htmlType:"submit",className:"login-form-button",onClick:this.postData},"Login"))))))}}]),t}(s.a.Component)),w=E.a.create()(v),S=(a(319),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).logout=function(){fetch("http://www.picchat.me/users/logout",{method:"Get"}).then(function(e){return e.json()}).then(function(e){console.log(e),a.setState({isLogout:!0}),h.a.success("Login success"),window.location.reload(),console.log("logout success",a.state.isLogout)})},a.state={isLogout:!1,login_username:"",email:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(this.state.isLogout){return s.a.createElement(d.a,{to:{pathname:"/"}})}return s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{id:"logout_button",onClick:this.logout,type:"link",icon:"logout"},"Logout"))}}]),t}(s.a.Component)),j=a(392),k=a(405),O=a(393),N=(a(320),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onClose=function(){a.setState({visible:!1,returnHome:!0})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||console.log("Received values of form: ",t)})},a.compareToUserEmail=function(){var e={email:a.state.email};""===a.state.email?a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input your E-mail address"}):/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(a.state.email)?fetch("http://www.picchat.me/users/verifyEmail",{method:"POST",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.text().then(function(e){"failure"===JSON.parse(e).status?a.setState({callbackResultEmail:"error",callbackTextEmail:"This E-mail already existed."}):a.setState({callbackResultEmail:"success",callbackTextEmail:"Available!"})})}):a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input correct email format!"})},a.compareToUserName=function(){var e={name:a.state.name};""===a.state.name?a.setState({callbackResultName:"error",callbackTextName:"Please input your user name"}):/^[ ]+$/.test(a.state.name)?a.setState({callbackResultName:"error",callbackTextName:"The first letter can't accept whitespace."}):fetch("http://www.picchat.me/users/verifyUsername",{method:"POST",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.text().then(function(e){"failure"===JSON.parse(e).status?a.setState({callbackResultName:"error",callbackTextName:"This user name already existed."}):a.setState({callbackResultName:"success",callbackTextName:"Available!"})})})},a.handleConfirmBlur=function(e){var t=e.target.value;a.setState({confirmDirty:a.state.confirmDirty||!!t})},a.compareToFirstPassword=function(e,t,n){var s=a.props.form;t&&t!==s.getFieldValue("password")?n("Not the same passowrd!"):n()},a.validateToNextPassword=function(e,t,n){var s=a.props.form;t&&a.state.confirmDirty&&s.validateFields(["confirm"],{force:!0}),n()},a.postData=function(){""===a.state.email&&a.setState({callbackResultEmail:"error",callbackTextEmail:"Please input your E-mail address"}),""===a.state.name&&a.setState({callbackResultName:"error",callbackTextName:"Please input your user name"});var e={email:a.state.email,name:a.state.name,password:a.state.password,avatar:a.state.avatar};a.props.form.validateFields(function(t){t||fetch("http://www.picchat.me/users/register",{method:"POST",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.text().then(function(e){"success"===JSON.parse(e).status&&(a.setState({isRegister:!0}),console.log(a.state.isRegister,"in"))})})})},a.login=function(){var e={email:a.state.email,password:a.state.password};a.props.form.validateFields(function(t){t||fetch("http://www.picchat.me/users/login",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){"failure"===e.status?h.a.error(e.message+"!Please try again!"):window.location.reload()})})},a.Vertified=function(){a.setState({visible:!1,returnHome:!0}),a.login()},a.changeAvatar=function(e){a.setState({avatar:e,closeAvatar:"",showAvatar:"none"})},a.showAvatar=function(){a.setState({closeAvatar:"none",showAvatar:""})},a.state={email:"",name:"",password:"",avatar:1,showAvatar:"none",closeAvatar:"",confirmDirty:!1,visible:!0,cancel:!1,isRegister:!1,returnHome:!1,callbackResultEmail:"",callbackTextEmail:"",callbackResultName:"",callbackTextName:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"handleChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){for(var e=this,t=this.props.form.getFieldDecorator,a="../avatars/"+this.state.avatar+".png",n=[],i=function(t){n.push(s.a.createElement(j.a,{key:t,size:"64",src:"../avatars/"+t+".png",onClick:function(){return e.changeAvatar(t)}}))},r=1;r<=16;r++)i(r);var o={pathname:"/",query:{name:this.state.name,email:this.state.email,id:"",status:!0}};return this.state.returnHome?s.a.createElement(d.a,{to:o}):this.state.isRegister?s.a.createElement("div",{id:"successRegister"},s.a.createElement(f.a,{title:"Register",width:460,closable:!1,visible:this.state.visible},s.a.createElement(k.a,{status:"success",title:"Well done^.^! Register success!",subTitle:"Welcome to UTS picChat community! You can post your interesting picture and react others now!",extra:[s.a.createElement(b.a,{type:"primary",onClick:this.Vertified,size:"large"},"Continue and Login")]}))):s.a.createElement("div",{id:"register"},s.a.createElement(f.a,{title:"Register",width:460,onClose:this.onClose,visible:this.state.visible},s.a.createElement(E.a,Object.assign({onSubmit:this.handleSubmit,className:"register-form"},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}),s.a.createElement(E.a.Item,{label:"Avatar:",hasFeedback:!0},s.a.createElement("div",{id:"avatarN",style:{display:this.state.showAvatar},className:"notChosen"},n),s.a.createElement("div",{id:"avatarY",style:{display:this.state.closeAvatar},className:"isChosen"},s.a.createElement(j.a,{id:"1",size:64,src:a,onClick:this.showAvatar}))),s.a.createElement(E.a.Item,{label:"E-mail",hasFeedback:!0,validateStatus:this.state.callbackResultEmail,help:this.state.callbackTextEmail},t("eamil",{rules:[{required:!0,message:"Please input your E-mail\uff01"}]})(s.a.createElement(g.a,{type:"email",prefix:s.a.createElement(y.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"E-mail",onBlur:this.compareToUserEmail,onChange:this.handleChangeEmail.bind(this)}))),s.a.createElement(E.a.Item,{label:"User Name",hasFeedback:!0,validateStatus:this.state.callbackResultName,help:this.state.callbackTextName},t("Name",{rules:[{required:!0,message:"Please input your name!"}]})(s.a.createElement(g.a,{prefix:s.a.createElement(y.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"User Name",onBlur:this.compareToUserName,onChange:this.handleChangeName.bind(this)}))),s.a.createElement(E.a.Item,{label:"Password",hasFeedback:!0},t("password",{rules:[{required:!0,message:"You need to setting password"},{min:6,message:"Minimum 6 letter"},{validator:this.validateToNextPassword}]})(s.a.createElement(g.a.Password,{prefix:s.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onChange:this.handleChangePassword.bind(this)}))),s.a.createElement(E.a.Item,{label:"Confirm",hasFeedback:!0},t("confirm",{rules:[{required:!0},{min:6,message:"Minimum 6 Letters\uff01"},{validator:this.compareToFirstPassword}]})(s.a.createElement(g.a.Password,{onBlur:this.handleConfirmBlur,placeholder:"Password",prefix:s.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}})}))),s.a.createElement(E.a.Item,null,s.a.createElement(b.a,{size:"large",type:"primary",htmlType:"submit",className:"register-form-button",onClick:this.postData},"Register"),s.a.createElement(O.a,{className:"divider"}),s.a.createElement("a",{href:"/login",id:"login_register",className:"login_text"},"Login Now")))))}}]),t}(s.a.Component)),R=E.a.create()(N),C=(a(164),a(27)),_=a(399),U=a(396),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).showModal=function(){a.setState({visible:!0})},a.disableUploadButton=function(){document.getElementsByClassName("ant-btn ant-btn-primary")[0].setAttribute("disabled","true")},a.enableUploadButton=function(){document.getElementsByClassName("ant-btn ant-btn-primary")[0].removeAttribute("disabled")},a.postTopic=function(){var e,t="";a.state.topicId?1==a.props.update?(t="http://www.picchat.me/topics",e={originalPicUrl:a.state.img_url_original,smallPicUrl:a.state.img_url_small,topic_id:a.state.topicId}):(t="http://www.picchat.me/topics/reply",e={originalPicUrl:a.state.img_url_original,replyTo:a.state.topicId}):(t="http://www.picchat.me/topics",e={originalPicUrl:a.state.img_url_original,smallPicUrl:a.state.img_url_small}),console.log(e),1==a.props.update?fetch(t,{method:"PUT",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.json()}).then(function(e){console.log(e)}):fetch(t,{method:"POST",body:JSON.stringify(e),headers:new Headers({"Content-Type":"application/json"})}).then(function(e){return e.json()}).then(function(e){console.log(e)}),a.setState({visible:!1,fileList:[]}),a.props.hideModal(),window.location.reload()},a.handleCancel=function(){a.props.hideModal(),a.setState({fileList:[],visible:!1})},a.state={visible:!1,img_url_original:"",img_url_small:"",fileList:[],topicId:a.props.topicId,uploadButtonDisabled:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onImageUpload",value:function(e){var t=Object(C.a)(e.fileList);t=t.slice(-1),this.setState({fileList:Object(C.a)(t)}),e.file.status,"done"===e.file.status?(this.setState({img_url_original:e.file.response[0],img_url_small:e.file.response[1]}),h.a.success("File uploaded successfully!"),this.enableUploadButton()):"error"==e.file.status&&h.a.error("The image contains text/unappropriate content and can't be uploaded.")}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"modal_window"},s.a.createElement(_.a,{title:this.props.boxHeader,visible:this.state.visible,okText:"Upload",onOk:function(){e.postTopic()},onCancel:this.handleCancel},s.a.createElement("div",{className:"image_upload"},s.a.createElement(U.a,{name:"image",action:"http://www.picchat.me/images/upload",onChange:function(t){e.onImageUpload(t)},fileList:this.state.fileList},s.a.createElement(b.a,null,s.a.createElement(y.a,{type:"upload"})," Click to upload image")))))}},{key:"componentDidUpdate",value:function(e){var t=this;e.showModal!=this.props.showModal&&this.setState({visible:this.props.showModal},function(){setTimeout(function(){return t.disableUploadButton()},100)}),e.topicId!=this.props.topicId&&this.setState({topicId:this.props.topicId})}}]),t}(s.a.Component),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).upload_props=void 0,a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.state={visible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{id:"add_topic"},s.a.createElement("div",{id:"add_button",onClick:this.showModal},s.a.createElement(y.a,{type:"plus"})),s.a.createElement(T,{showModal:this.state.visible,hideModal:this.handleCancel,boxHeader:"Upload new picture to start new topic"}))}}]),t}(s.a.PureComponent),L=a(402),I=a(408),x=a(401),P=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={unread:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://www.picchat.me/notifications/unread",{method:"GET",headers:{"Content-type":"application/json"}}).then(function(e){return e.json()}).then(function(t){e.setState({unread:t.length})})}},{key:"render",value:function(){var e=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{key:"1"},s.a.createElement(p.b,{to:"/user"},s.a.createElement(b.a,{type:"link",icon:"picture"},"My posts"))),s.a.createElement(L.a.Item,{key:"2"},s.a.createElement(p.b,{to:"/user/notifications"},s.a.createElement(b.a,{type:"link",icon:"notification"},"Notifications"),s.a.createElement(I.a,{count:this.state.unread}))),s.a.createElement(L.a.Item,{key:"3"},s.a.createElement(p.b,{to:"/user/setting"},s.a.createElement(b.a,{type:"link",icon:"setting"},"Setting"))),s.a.createElement(L.a.Item,{key:"4"},s.a.createElement(S,null)));if(this.props.isLogin){var t="../avatars/"+this.props.avatar+".png";return s.a.createElement("div",{id:"header"},s.a.createElement(p.b,{id:"logo",to:"/"},"picChat"),s.a.createElement(M,null),s.a.createElement("div",{id:"user_menu"},s.a.createElement(x.a,{overlay:e},s.a.createElement("div",{id:"user_info"},s.a.createElement(I.a,{count:this.state.unread,offset:[0,2]},s.a.createElement(j.a,{size:40,src:t})),s.a.createElement("span",{className:"name"},this.props.userName)))))}return s.a.createElement("div",{id:"header"},s.a.createElement(p.b,{id:"logo",to:"/"},"picChat"),s.a.createElement(M,null),s.a.createElement("div",{id:"login"},s.a.createElement(p.a,null,s.a.createElement(p.b,{to:"/login",className:"login"},"Login"),s.a.createElement(p.b,{to:"/register",className:"register"},"Register"),s.a.createElement("div",null,s.a.createElement(d.b,{path:"/login",component:w}),s.a.createElement(d.b,{path:"/register",component:R})))))}}]),t}(s.a.Component),A=a(395),F=a(394),D=(a(384),y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"})),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).updateReacts=a.props.updateReacts(),a.deleteReacts=a.props.deleteReacts(),a.reactToTopic=function(e,t){a.setState({isLoading:!0});var n=a.state.yourReact;if(n)if(n.emoji===t){a.setState({isLoading:!0});var s={react_id:n._id};fetch("http://www.picchat.me/reacts",{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(s)}).then(function(e){return e.json()}).then(function(e){a.setState({yourReact:"",isLoading:!1}),a.deleteReacts(e.deleteId),h.a.success("React Deleted Successfully")})}else{a.setState({isLoading:!0});var i={react_id:n._id,emoji:t};fetch("http://www.picchat.me/reacts",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(i)}).then(function(e){return e.json()}).then(function(e){"failure"===e.status?console.log("not login yet"):(a.setState({yourReact:{_id:e.newReact._id,emoji:t},isLoading:!1}),a.updateReacts(e.newReact),h.a.success("React Updated Successfully"))})}else{var r={topic_id:e,emoji:t};fetch("http://www.picchat.me/reacts",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(r)}).then(function(e){return e.json()}).then(function(e){"failure"===e.status?h.a.error("You need to login to react"):(a.setState({yourReact:{_id:e.newReact._id,emoji:t},isLoading:!1}),a.updateReacts(e.newReact),h.a.success("React Successfully"))})}},a.state={isLoading:!1,yourReact:a.props.yourReact,types:["a","baiyan","aixin","daxiao","fadai","ganga","hanyan","liulei","xiaochulei","shengqi","feiwen","huaixiao","santiaoxian","yiwen","siliao"]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.yourReact!==e.yourReact&&this.setState({yourReact:this.props.yourReact})}},{key:"render",value:function(){var e=this,t=s.a.createElement("div",{className:"emoji_box"},this.state.types.map(function(t){return s.a.createElement("span",{key:t,className:e.state.yourReact.emoji===t?"isActive":"",onClick:function(){return e.reactToTopic(e.props.topicId,t)}},s.a.createElement(D,{type:"icon-"+t}))})),a=s.a.createElement(s.a.Fragment,null,s.a.createElement("strong",{className:"pop_head"},"React"),this.state.isLoading&&s.a.createElement(y.a,{type:"loading",style:{color:"#1890ff"}}));return s.a.createElement(F.a,{title:a,content:t,placement:"bottom"},s.a.createElement(y.a,{className:"add_react",type:"smile",theme:"twoTone",twoToneColor:"#1890ff",style:{fontSize:"24px"}}))}}]),t}(s.a.Component),H=(a(385),y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"})),B=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={reacts:a.props.reacts,showUploadModal:!1,showUploadModalReply:!1},a.updateReacts=function(e){for(var t=!1,n=a.state.reacts,s=0;s<a.state.reacts.length;s++){a.state.reacts[s]._id===e._id&&(t=!0,n[s].emoji=e.emoji)}t?a.setState({reacts:n}):a.setState(function(t){return{reacts:[].concat(Object(C.a)(t.reacts),[e])}})},a.deleteReacts=function(e){for(var t=a.state.reacts,n=0;n<t.length;n++)if(t[n]._id===e)return t.splice(n,1),void a.setState({reacts:t})},a.showModal=function(){a.setState({showUploadModal:!0})},a.showModalReply=function(){a.setState({showUploadModalReply:!0})},a.handleCancelUploadReply=function(){a.setState({showUploadModalReply:!1})},a.handleCancelUpload=function(){a.setState({showUploadModal:!1})},a.handleDeleteTopic=function(){var e={topic_id:a.props.topicId};0==a.props.replies.length?fetch("http://www.picchat.me/topics/",{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if("success"===e.status){h.a.success("Delete Successfully!");setTimeout(function(){window.location.reload()},2e3)}}):h.a.error("You can't delete this topic")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{onClick:function(){return e.showModalReply()}},s.a.createElement(y.a,{type:"redo"}),"Update"),s.a.createElement(L.a.Item,{onClick:function(){return e.handleDeleteTopic()}},s.a.createElement(y.a,{type:"delete"}),"Delete"));return s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"header_panel"},s.a.createElement("div",{className:"user_info"},s.a.createElement(j.a,{src:"../avatars/"+this.props.avatar+".png",size:40}),s.a.createElement("div",{className:"name_date"},s.a.createElement("strong",null,this.props.name),s.a.createElement("span",{className:"date"},"posted on ",this.props.createAt.substr(0,10)))),this.props.user.name===this.props.name&&s.a.createElement("div",{className:"settings"},s.a.createElement(x.a,{overlay:t,placement:"bottomCenter"},s.a.createElement(y.a,{type:"more"})))),s.a.createElement("div",{className:"img_box"},s.a.createElement(p.b,{to:"/topics_detail/".concat(this.props.topicId)},s.a.createElement("img",{src:this.props.smallPicUrl,alt:this.props.smallPicUrl}))),s.a.createElement("div",{className:"interact_box"},this.state.reacts.length>0&&s.a.createElement("div",{className:"current_reacts"},this.state.reacts.map(function(e){return s.a.createElement("span",{key:e._id},s.a.createElement(H,{type:"icon-"+e.emoji}))})),s.a.createElement("div",{className:"buttons_box"},s.a.createElement(z,{topicId:this.props.topicId,yourReact:this.props.yourReact,updateReacts:function(){return e.updateReacts},deleteReacts:function(){return e.deleteReacts}}),s.a.createElement(y.a,{className:"add_reply",type:"picture",theme:"twoTone",twoToneColor:"#1890ff",style:{fontSize:"24px"},onClick:this.showModal}))),this.props.replies.length>0&&s.a.createElement("div",{className:"replies"},s.a.createElement(p.b,{to:"/topics_detail/".concat(this.props.topicId)},this.props.replies.length," replies")),s.a.createElement(T,{showModal:this.state.showUploadModal,hideModal:this.handleCancelUpload,boxHeader:"Upload new picture to reply on topic",topicId:this.props.topicId}),s.a.createElement(T,{showModal:this.state.showUploadModalReply,hideModal:this.handleCancelUploadReply,boxHeader:"Update picture",topicId:this.props.topicId,update:!0}))}}]),t}(s.a.Component),J=a(409),Y=(a(386),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).showFromNewtoOld=function(e,t,n){a.setState({isLoading:!0}),n&&a.setState({topics:[],page:0}),fetch("http://www.picchat.me/topics?sort=1&size="+e+"&page="+t).then(function(e){return e.json()}).then(function(e){a.setState({isLoading:!1,sort:1,topics:[].concat(Object(C.a)(a.state.topics),Object(C.a)(e)),tags:"From New to Old",page:a.state.page+1,canLoad:!(e.length<a.state.pageSize)})})},a.showFromOldtoNew=function(e,t,n){a.setState({isLoading:!0}),n&&a.setState({topics:[],page:0}),fetch("http://www.picchat.me/topics?sort=2&size="+e+"&page="+t).then(function(e){return e.json()}).then(function(e){a.setState({isLoading:!1,sort:2,topics:[].concat(Object(C.a)(a.state.topics),Object(C.a)(e)),tags:"From Old to New",page:a.state.page+1,canLoad:!(e.length<a.state.pageSize)})})},a.showFromLowtoHigh=function(e,t,n){a.setState({isLoading:!0}),n&&a.setState({topics:[],page:0}),fetch("http://www.picchat.me/topics?sort=3&size="+e+"&page="+t).then(function(e){return e.json()}).then(function(e){a.setState({isLoading:!1,sort:3,topics:[].concat(Object(C.a)(a.state.topics),Object(C.a)(e)),tags:"From Low to High",page:a.state.page+1,canLoad:!(e.length<a.state.pageSize)})})},a.showFromHightoLow=function(e,t,n){a.setState({isLoading:!0}),n&&a.setState({topics:[],page:0}),fetch("http://www.picchat.me/topics?sort=4&size="+e+"&page="+t).then(function(e){return e.json()}).then(function(e){a.setState({isLoading:!1,sort:4,topics:[].concat(Object(C.a)(a.state.topics),Object(C.a)(e)),tags:"From High to Low",page:a.state.page+1,canLoad:!(e.length<a.state.pageSize)})})},a.loadMore=function(e){switch(e){case 1:a.showFromNewtoOld(a.state.pageSize,a.state.page,!1);break;case 2:a.showFromOldtoNew(a.state.pageSize,a.state.page,!1);break;case 3:a.showFromLowtoHigh(a.state.pageSize,a.state.page,!1);break;case 4:a.showFromHightoLow(a.state.pageSize,a.state.page,!1)}},a.state={isLoading:!0,sort:1,topics:[],tags:"From New to Old",pageSize:6,page:0,canLoad:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.showFromNewtoOld(this.state.pageSize,this.state.page,!0)}},{key:"render",value:function(){var e=this,t=this.props.user,a=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{key:"1",onClick:function(){return e.showFromNewtoOld(e.state.pageSize,0,!0)}},"New to Old"),s.a.createElement(L.a.Item,{key:"2",onClick:function(){return e.showFromOldtoNew(e.state.pageSize,0,!0)}},"Old to New")),n=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{key:"1",onClick:function(){return e.showFromLowtoHigh(e.state.pageSize,0,!0)}},"Low to High"),s.a.createElement(L.a.Item,{key:"2",onClick:function(){return e.showFromHightoLow(e.state.pageSize,0,!0)}},"High to low")),i=this.state.topics.map(function(e){return s.a.createElement(B,{user:t,key:e._id,smallPicUrl:e.smallPicUrl,name:e.createBy.name,avatar:e.createBy.avatar,createAt:e.createAt,topicId:e._id,replies:e.replies,reacts:e.reacts,yourReact:e.yourReact?e.yourReact:""})});return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"topic_list_tab"},s.a.createElement("div",{className:"sort_buttons"},s.a.createElement(x.a,{overlay:a},s.a.createElement(b.a,null,s.a.createElement(y.a,{type:"calendar"}),"Recency")),s.a.createElement(x.a,{overlay:n},s.a.createElement(b.a,{className:"popularity"},s.a.createElement(y.a,{type:"fire"}),"Popularity"))),s.a.createElement("div",{className:"sort_feedback"},s.a.createElement("span",{className:"sort"},"Sort By:"),s.a.createElement(J.a,{color:"gold"},this.state.tags))),s.a.createElement("div",{id:"topic_list"},i),this.state.isLoading&&s.a.createElement("div",{className:"topic_list_loading_box"},s.a.createElement(y.a,{type:"loading",style:{color:"#1890ff",fontSize:"40px"}}),s.a.createElement("p",null,"Loading...")),this.state.canLoad&&s.a.createElement(b.a,{id:"load_more",onClick:function(){return e.loadMore(e.state.sort)}},"Loading more..."),!this.state.canLoad&&s.a.createElement("div",{className:"nomore"},s.a.createElement(y.a,{style:{fontSize:"34px"},type:"build"}),s.a.createElement("p",null,"More pictures are coming")))}}]),t}(s.a.Component)),q=a(70),G=(a(134),y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"})),W=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).updateReacts=function(e){for(var t=!1,n=a.state.reacts,s=0;s<a.state.reacts.length;s++){a.state.reacts[s]._id===e._id&&(t=!0,n[s].emoji=e.emoji)}t?a.setState({reacts:n}):a.setState(function(t){return{reacts:[].concat(Object(C.a)(t.reacts),[e])}})},a.deleteReacts=function(e){for(var t=a.state.reacts,n=0;n<t.length;n++)if(t[n]._id===e)return t.splice(n,1),void a.setState({reacts:t})},a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.showModalReply=function(){a.setState({showUploadModalReply:!0})},a.handleCancelUploadReply=function(){a.setState({showUploadModalReply:!1})},a.handleDeleteTopic=function(){var e={topic_id:a.props.topicId};0==a.props.replies.length?fetch("http://www.picchat.me/topics/",{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if("success"===e.status){h.a.success("Delete Successfully!");setTimeout(function(){window.location.reload()},2e3)}}):h.a.error("You can't delete this topic")},a.state={reacts:a.props.reacts,visible:!1,showUploadModalReply:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{onClick:function(){return e.showModalReply()}},s.a.createElement(y.a,{type:"redo"}),"Update"),s.a.createElement(L.a.Item,{onClick:function(){return e.handleDeleteTopic()}},s.a.createElement(y.a,{type:"delete"}),"Delete"));return s.a.createElement("div",{className:"level3",key:this.props.topicId},s.a.createElement("div",{className:"basic_info"},s.a.createElement("div",{className:"header_panel"},s.a.createElement("div",{className:"user_info"},s.a.createElement(j.a,{src:"../avatars/"+this.props.avatar+".png"}),s.a.createElement("div",{className:"name_date"},s.a.createElement("strong",null,this.props.name),s.a.createElement("span",{className:"date"},"posted on ",this.props.createAt.substr(0,10))))),s.a.createElement("div",{className:"replyto"},s.a.createElement("span",null),s.a.createElement("em",null,this.props.replyTo),s.a.createElement("strong",null,"Reply to"))),s.a.createElement("div",{className:"img_box"},s.a.createElement("img",{src:this.props.originalPicUrl}),this.state.reacts.length>0&&s.a.createElement("div",{className:"reacts_box"},this.state.reacts.map(function(e){return s.a.createElement("span",{key:e._id},s.a.createElement(G,{type:"icon-"+e.emoji}))}))),s.a.createElement("div",{className:"button_box"},this.props.loginUser.name===this.props.name&&s.a.createElement("div",{className:"settings"},s.a.createElement(x.a,{overlay:t,placement:"bottomCenter"},s.a.createElement(y.a,{type:"more"}))),s.a.createElement(z,{topicId:this.props.topicId,yourReact:this.props.yourReact,updateReacts:function(){return e.updateReacts},deleteReacts:function(){return e.deleteReacts}}),s.a.createElement(y.a,{className:"add_reply",type:"picture",theme:"twoTone",twoToneColor:"#1890ff",style:{fontSize:"24px"},onClick:this.showModal}),s.a.createElement(T,{showModal:this.state.visible,hideModal:this.handleCancel,boxHeader:"Upload new picture to reply on topic",topicId:this.props.topicId}),s.a.createElement(T,{showModal:this.state.showUploadModalReply,hideModal:this.handleCancelUploadReply,boxHeader:"Update picture",topicId:this.props.topicId,update:!0})))}}]),t}(s.a.Component),V=y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"}),$=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).updateReacts=function(e){for(var t=!1,n=a.state.reacts,s=0;s<a.state.reacts.length;s++){a.state.reacts[s]._id===e._id&&(t=!0,n[s].emoji=e.emoji)}t?a.setState({reacts:n}):a.setState(function(t){return{reacts:[].concat(Object(C.a)(t.reacts),[e])}})},a.deleteReacts=function(e){for(var t=a.state.reacts,n=0;n<t.length;n++)if(t[n]._id===e)return t.splice(n,1),void a.setState({reacts:t})},a.showModal=function(){a.setState({visible:!0})},a.showModalReply=function(){a.setState({showUploadModalReply:!0})},a.handleCancelUploadReply=function(){a.setState({showUploadModalReply:!1})},a.handleCancel=function(){a.setState({visible:!1})},a.handleDeleteTopic=function(){var e={topic_id:a.props.topicId};0==a.props.replies.length?fetch("http://www.picchat.me/topics/",{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if("success"===e.status){h.a.success("Delete Successfully!");setTimeout(function(){window.location.reload()},2e3)}}):h.a.error("You can't delete this topic")},a.state={reacts:a.props.reacts,visible:!1,showUploadModalReply:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.replies.map(function(t){return s.a.createElement(W,{key:t._id,originalPicUrl:t.originalPicUrl,name:t.createBy.name,avatar:t.createBy.avatar,replies:t.replies,createAt:t.createAt,topicId:t._id,reacts:t.reacts,yourReact:t.yourReact?t.yourReact:"",replyTo:t.replyTo.createBy.name,loginUser:e.props.loginUser?e.props.loginUser:{}})}),a=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{onClick:function(){return e.showModalReply()}},s.a.createElement(y.a,{type:"redo"})," Update"),s.a.createElement(L.a.Item,{onClick:function(){return e.handleDeleteTopic()}},s.a.createElement(y.a,{type:"delete"})," Delete"));return s.a.createElement("div",{className:"single_reply"},s.a.createElement("div",{className:"level2"},s.a.createElement("div",{className:"header_panel"},s.a.createElement("div",{className:"user_info"},s.a.createElement(j.a,{src:"../avatars/"+this.props.avatar+".png"}),s.a.createElement("div",{className:"name_date"},s.a.createElement("strong",null,this.props.name),s.a.createElement("span",{className:"date"},"posted on ",this.props.createAt.substr(0,10))))),s.a.createElement("div",{className:"img_box"},s.a.createElement("img",{src:this.props.originalPicUrl}),this.state.reacts.length>0&&s.a.createElement("div",{className:"reacts_box"},this.state.reacts.map(function(e){return s.a.createElement("span",{key:e._id},s.a.createElement(V,{type:"icon-"+e.emoji}))}))),s.a.createElement("div",{className:"button_box"},this.props.loginUser.name===this.props.name&&s.a.createElement("div",{className:"settings"},s.a.createElement(x.a,{overlay:a,placement:"bottomCenter"},s.a.createElement(y.a,{type:"more"}))),s.a.createElement(z,{topicId:this.props.topicId,yourReact:this.props.yourReact,updateReacts:function(){return e.updateReacts},deleteReacts:function(){return e.deleteReacts}}),s.a.createElement(y.a,{className:"add_reply",type:"picture",theme:"twoTone",twoToneColor:"#1890ff",style:{fontSize:"24px"},onClick:this.showModal}),s.a.createElement(T,{showModal:this.state.visible,hideModal:this.handleCancel,boxHeader:"Upload new picture to reply",topicId:this.props.topicId}),s.a.createElement(T,{showModal:this.state.showUploadModalReply,hideModal:this.handleCancelUploadReply,boxHeader:"Update picture",topicId:this.props.topicId,update:!0}))),t)}}]),t}(s.a.Component),K=y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"}),Q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).showModal=function(){a.setState({showUploadModal:!0})},a.showModalReply=function(){a.setState({showUploadModalReply:!0})},a.handleCancelUpload=function(){a.setState({showUploadModal:!1})},a.handleCancelUploadReply=function(){a.setState({showUploadModalReply:!1})},a.updateReacts=function(e){for(var t=!1,n=a.state.reacts,s=0;s<a.state.reacts.length;s++){a.state.reacts[s]._id===e._id&&(t=!0,n[s].emoji=e.emoji)}t?a.setState({reacts:n}):a.setState(function(t){return{reacts:[].concat(Object(C.a)(t.reacts),[e])}})},a.deleteReacts=function(e){for(var t=a.state.reacts,n=0;n<t.length;n++)if(t[n]._id===e)return t.splice(n,1),void a.setState({reacts:t})},a.handleDeleteTopic=function(){var e={topic_id:a.state.id};0==a.state.replies.length?fetch("http://www.picchat.me/topics/",{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if("success"===e.status){h.a.success("Delete Successfully!");setTimeout(function(){window.location.href="/"},2e3)}}):h.a.error("You can't delete this topic")},a.state={loginUser:{},isLoading:!0,id:"",name:"",avatar:1,originalPicUrl:"",createAt:"",replies:[],reacts:[],yourReact:"",showUploadModal:!1,showUploadModalReply:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://www.picchat.me/topics/single?id="+this.props.match.params.id).then(function(e){return e.json()}).then(function(t){var a=t;e.setState({isLoading:!1,id:a._id,name:a.createBy.name,avatar:a.createBy.avatar,originalPicUrl:a.originalPicUrl,createAt:a.createAt,replies:a.replies,reacts:a.reacts,yourReact:a.yourReact?a.yourReact:""})}),fetch("http://www.picchat.me/users").then(function(e){return e.json()}).then(function(t){"success"===t.status?e.setState({loginUser:{name:t.user.name,email:t.user.email,id:t.user.id,avatar:t.user.avatar}}):e.setState({loginUser:{}})})}},{key:"render",value:function(){var e=this,t=this.state.replies.map(function(t){return s.a.createElement($,{key:t._id,originalPicUrl:t.originalPicUrl,name:t.createBy.name,avatar:t.createBy.avatar,replies:t.replies,createAt:t.createAt,topicId:t._id,reacts:t.reacts,yourReact:t.yourReact?t.yourReact:"",loginUser:e.state.loginUser?e.state.loginUser:{}})}),a=s.a.createElement(L.a,null,s.a.createElement(L.a.Item,{onClick:function(){return e.showModalReply()}},s.a.createElement(y.a,{type:"redo"})," Update"),s.a.createElement(L.a.Item,{onClick:function(){return e.handleDeleteTopic()}},s.a.createElement(y.a,{type:"delete"}),"Delete"));return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{id:"topic_detail"},s.a.createElement("div",{className:"header_panel"},s.a.createElement("div",{id:"author_info"},this.state.isLoading&&s.a.createElement("div",{className:"loading_box"},s.a.createElement(y.a,{type:"loading",style:{color:"#1890ff",fontSize:"40px"}})),!this.state.isLoading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(j.a,{src:"../avatars/"+this.state.avatar+".png",size:40}),s.a.createElement("div",{className:"name_date"},s.a.createElement("strong",null,this.state.name),s.a.createElement("span",{className:"date"},"posted on ",this.state.createAt.substr(0,10))))),this.state.loginUser.name===this.state.name&&s.a.createElement("div",{className:"settings"},s.a.createElement(x.a,{overlay:a,placement:"bottomCenter"},s.a.createElement(y.a,{type:"more"})))),s.a.createElement("div",{id:"main_pic"},this.state.isLoading&&s.a.createElement("div",{className:"loading_box"},s.a.createElement(y.a,{type:"loading",style:{color:"#1890ff",fontSize:"40px"}})),!this.state.isLoading&&s.a.createElement("img",{src:this.state.originalPicUrl}),this.state.reacts.length>0&&s.a.createElement("div",{className:"reacts_box"},this.state.reacts.map(function(e){return s.a.createElement("span",{key:e._id},s.a.createElement(K,{type:"icon-"+e.emoji}))}))),s.a.createElement("div",{className:"buttons_box"},s.a.createElement(z,{topicId:this.state.id,yourReact:this.state.yourReact,updateReacts:function(){return e.updateReacts},deleteReacts:function(){return e.deleteReacts}}),s.a.createElement(y.a,{className:"add_reply",type:"picture",theme:"twoTone",twoToneColor:"#1890ff",style:{fontSize:"24px"},onClick:this.showModal}))),s.a.createElement("div",{id:"replies_list"},s.a.createElement("h2",null,"Replies"),0==t.length&&s.a.createElement(q.a,{image:q.a.PRESENTED_IMAGE_SIMPLE,description:"There is no reply yet"}),t),s.a.createElement(T,{showModal:this.state.showUploadModal,hideModal:this.handleCancelUpload,boxHeader:"Upload new picture to reply on topic",topicId:this.state.id}),s.a.createElement(T,{showModal:this.state.showUploadModalReply,hideModal:this.handleCancelUploadReply,boxHeader:"Update picture",topicId:this.state.id,update:!0}))}}]),t}(s.a.Component),X=a(397),Z=(a(387),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={filter:"reacts",userList:[]},a.showMostReacts=function(){a.setState({filter:"reacts"}),fetch("http://www.picchat.me/users/leaderboard?type=mostReacts").then(function(e){return e.json()}).then(function(e){a.setState({userList:e})})},a.showMostTopics=function(){a.setState({filter:"topics"}),fetch("http://www.picchat.me/users/leaderboard?type=mostTopics").then(function(e){return e.json()}).then(function(e){a.setState({userList:e})})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.showMostReacts()}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h3",null,s.a.createElement(y.a,{type:"unordered-list"}),"Leaderboard"),s.a.createElement("div",{className:"filter"},s.a.createElement("button",{className:"reacts"===this.state.filter?"isActive":"",onClick:this.showMostReacts},s.a.createElement(y.a,{type:"smile"})," Reacts"),s.a.createElement("button",{className:"topics"===this.state.filter?"isActive":"",onClick:this.showMostTopics},s.a.createElement(y.a,{type:"picture"})," Topics")),s.a.createElement(X.a,{id:"leaderboard_list",dataSource:this.state.userList,renderItem:function(t){return s.a.createElement(X.a.Item,null,s.a.createElement(X.a.Item.Meta,{avatar:s.a.createElement(j.a,{src:"../avatars/"+t.avatar+".png"}),title:t.name,key:t._id,description:"reacts"===e.state.filter?"React Times: "+t.reactTimes:"Post Topics: "+t.topicTimes}))}}))}}]),t}(s.a.Component)),ee=A.a.Sider,te=A.a.Content,ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(A.a,null,s.a.createElement(te,null,s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/topics_detail/:id",component:Q}),s.a.createElement(d.b,{path:"/",exact:!0,render:function(){return s.a.createElement(Y,{user:e.props.user})}}))),s.a.createElement(ee,{className:"leaderboard",breakpoint:"lg",collapsedWidth:"0",reverseArrow:!0},s.a.createElement(Z,null)))}}]),t}(s.a.Component),ne=(a(77),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={topics:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://www.picchat.me/topics/fromUser").then(function(e){return e.json()}).then(function(t){e.setState({topics:t})})}},{key:"render",value:function(){var e=this,t=this.state.topics.map(function(t){return s.a.createElement(B,{user:e.props.user,key:t._id,smallPicUrl:t.smallPicUrl,name:t.createBy.name,avatar:t.createBy.avatar,createAt:t.createAt,topicId:t._id,replies:t.replies,reacts:t.reacts,yourReact:t.yourReact?t.yourReact:""})});return s.a.createElement(s.a.Fragment,null,s.a.createElement("h2",null,"My Posts"),s.a.createElement("div",{id:"user_topic_list"},0==t.length&&s.a.createElement(q.a,{image:q.a.PRESENTED_IMAGE_SIMPLE,description:"You haven't posted any topics"}),t))}}]),t}(s.a.Component)),se=y.a.createFromIconfontCN({scriptUrl:"/iconfont.js"}),ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getAllNoti=function(){fetch("http://www.picchat.me/notifications/toUser").then(function(e){return e.json()}).then(function(e){a.setState({notifications:e})})},a.markAsRead=function(e){var t={notification_id:e};fetch("http://www.picchat.me/notifications/markread",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){a.getAllNoti()})},a.state={notifications:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getAllNoti()}},{key:"render",value:function(){var e=this;return this.state.notifications.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement("h2",null,"Notifications"),s.a.createElement("div",{id:"notifications"},s.a.createElement(X.a,{itemLayout:"horizontal",dataSource:this.state.notifications,renderItem:function(t){return s.a.createElement(X.a.Item,{className:0==t.isRead?"unread":""},s.a.createElement(X.a.Item.Meta,{avatar:s.a.createElement(j.a,{src:"../avatars/"+t.fromUser.avatar+".png"}),title:"You have a new "+t.type,description:s.a.createElement(s.a.Fragment,null,s.a.createElement("strong",{className:"from"},t.fromUser.name),s.a.createElement("p",{className:"text"},"has reacted to your picture with "),s.a.createElement(se,{type:"icon-"+t.content}),s.a.createElement(p.b,{to:"/topics_detail/".concat(t.atTopic)},"Link"),0==t.isRead&&s.a.createElement("em",{onClick:function(){return e.markAsRead(t._id)}},s.a.createElement(y.a,{type:"highlight"}),"Mark as read"))}))}}))):s.a.createElement(s.a.Fragment,null,s.a.createElement("h2",null,"Notifications"),s.a.createElement(q.a,{image:q.a.PRESENTED_IMAGE_SIMPLE,description:"You have no notifications yet"}))}}]),t}(s.a.Component),re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).swtichOnAvatarList=function(){a.setState({onChanging:!a.state.onChanging})},a.onChangeAvatar=function(e){a.setState({avatar:e})},a.onSubmit=function(){var e={avatar:a.state.avatar};fetch("http://www.picchat.me/users",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){"success"===e.status&&h.a.success("Avatar updated Successfully!")})},a.state={onChanging:!1,avatar:a.props.user.avatar},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){t.push(s.a.createElement("div",{key:a,onClick:function(){return e.onChangeAvatar(a)}},s.a.createElement(j.a,{size:64,src:"../avatars/"+a+".png"})))},n=1;n<=16;n++)a(n);return s.a.createElement(s.a.Fragment,null,s.a.createElement("h2",null,"My Settings"),s.a.createElement("div",{id:"user_setting"},s.a.createElement("p",null,"Change your avatar:"),s.a.createElement("div",{className:"currentAvatar"},s.a.createElement("div",{className:"avatar_display",onClick:function(){return e.swtichOnAvatarList()}},s.a.createElement(j.a,{className:"avatar",size:64,src:"../avatars/"+this.state.avatar+".png"})),s.a.createElement(b.a,{className:"save",type:"primary",onClick:this.onSubmit},"Save")),this.state.onChanging&&s.a.createElement("div",{className:"avatar_list"},t)))}}]),t}(s.a.Component),oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(L.a,{id:"user_panel_menu",defaultSelectedKeys:["/user"],theme:"light",mode:"inline",selectedKeys:[this.props.location.pathname]},s.a.createElement(L.a.Item,{key:"/user"},s.a.createElement(p.b,{to:"/user"},s.a.createElement(y.a,{type:"picture"}),s.a.createElement("span",null,"My posts"))),s.a.createElement(L.a.Item,{key:"/user/notifications"},s.a.createElement(p.b,{to:"/user/notifications"},s.a.createElement(y.a,{type:"notification"}),s.a.createElement("span",null,"Notifications"))),s.a.createElement(L.a.Item,{key:"/user/setting"},s.a.createElement(p.b,{to:"/user/setting"},s.a.createElement(y.a,{type:"setting"}),s.a.createElement("span",null,"Settings"))))}}]),t}(s.a.Component),ce=A.a.Sider,le=A.a.Content,ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={topics:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return""!==this.props.user.name?s.a.createElement(A.a,null,s.a.createElement(ce,{width:240,style:{background:"#fff"}},s.a.createElement(d.b,{path:"/user",component:oe})),s.a.createElement(le,null,s.a.createElement("div",{id:"user_panel"},s.a.createElement(d.b,{path:"/user",exact:!0,render:function(){return s.a.createElement(ne,{user:e.props.user})}}),s.a.createElement(d.b,{path:"/user/notifications",component:ie}),s.a.createElement(d.b,{path:"/user/setting",render:function(){return s.a.createElement(re,{user:e.props.user})}})))):s.a.createElement(d.a,{to:"/"})}}]),t}(s.a.Component),me=(a(389),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("footer",null,s.a.createElement("div",{className:"footer-logo"},s.a.createElement("img",{src:"/images/logo-footer.png"})),s.a.createElement("div",{className:"copyright"},s.a.createElement("p",null,"Made with ",s.a.createElement(y.a,{type:"heart",theme:"filled",style:{color:"#eb2f96"}})," at UTS")))}}]),t}(s.a.Component)),pe=a(407),de=a(404),he=(a(390),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={user:{name:"",email:"",id:"",avatar:""},isLogin:!1},a.getLoginUser=function(){fetch("http://www.picchat.me/users").then(function(e){return e.json()}).then(function(e){"success"===e.status?a.setState({user:{name:e.user.name,email:e.user.email,id:e.user.id,avatar:e.user.avatar},isLogin:!0}):a.setState({isLogin:!1})})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getLoginUser()}},{key:"render",value:function(){var e=this;return s.a.createElement(p.a,null,s.a.createElement("div",{className:"App",id:"App"},s.a.createElement(pe.a,null,s.a.createElement(P,{userName:this.state.user.name,isLogin:this.state.isLogin,avatar:this.state.user.avatar})),s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/user",render:function(){return s.a.createElement(ue,{user:e.state.user})}}),s.a.createElement(d.b,{path:"/",render:function(){return s.a.createElement(ae,{user:e.state.user})}})),s.a.createElement(de.a,null,s.a.createElement("div",{className:"ant-back-top-inner"},s.a.createElement(y.a,{type:"arrow-up"}))),s.a.createElement(me,null)))}}]),t}(s.a.Component));r.a.render(s.a.createElement(he,null),document.querySelector("#root"))},77:function(e,t,a){}},[[192,1,2]]]);
//# sourceMappingURL=main.37440062.chunk.js.map